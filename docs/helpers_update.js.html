<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>helpers/update.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Namespaces</li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="Clustering.html">Clustering</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Clustering.html#.getAreasPageRank">getAreasPageRank</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Clustering.html#.getDepValuesByYear">getDepValuesByYear</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Clustering.html#.getMonths">getMonths</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Clustering.html#.getTotalByYear">getTotalByYear</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="Info.html">Info</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Info.html#.getAgeRanges">getAgeRanges</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Info.html#.getMonthsValues">getMonthsValues</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Info.html#.getPageRank">getPageRank</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Info.html#.getTopAreas">getTopAreas</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Info.html#.getTopCountries">getTopCountries</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Info.html#.getTopRegions">getTopRegions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Info.html#.getTotByYear">getTotByYear</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="International.html">International</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="International.html#.getCountriesValuesByYear">getCountriesValuesByYear</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="International.html#.getMonths">getMonths</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="International.html#.getTotalByYear">getTotalByYear</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="National.html">National</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="National.html#.getMonths">getMonths</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="National.html#.getRegionsPageRank">getRegionsPageRank</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="National.html#.getRegionsValuesByYear">getRegionsValuesByYear</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="National.html#.getTotalByYear">getTotalByYear</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="Stats.html">Stats</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#.getDatabaseCountryStats">getDatabaseCountryStats</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#.getDatabaseDepStats">getDatabaseDepStats</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#.getDatabaseStats">getDatabaseStats</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#ages">ages</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#capitalize">capitalize</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#diff">diff</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#diffGoing">diffGoing</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#formatNumber">formatNumber</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#nameQuery">nameQuery</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#percentDiff">percentDiff</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#region">region</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#roundDecimal">roundDecimal</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">helpers/update.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Formats age for query process
 * @param {String} age - String to modify
 * 
 * @return {String} formated string 
 */
exports.ages = (age) => {
  if(age == "all" ||Â age == null || age == "-")
    return "";
  else
    return " and a1.age = '"+age+"'"
};

/**
 * Formats region for query process
 * @param {String} region - String to modify
 * 
 * @return {String} formated string 
 */
exports.region = (region) => {
  return ' a0.name_1 = \''+region+'\' AND a2.name_1 = \''+region+'\' '
};

/**
 * Create differential array to compare ingoing/outgoig values over years
 * @param {String} region - String to modify
 * 
 * @return {String} formated string 
 */
exports.diffGoing = (array) => {
  for (var region in array) {
    for (var year in array[region]) {
      ingoing = Number(array[region][eval(year) + 1]['Ingoing'] - array[region][year]['Ingoing']);
      outgoing = Number(array[region][eval(year) + 1]['Outgoing'] - array[region][year]['Outgoing']);
      array[region]['diff'] = {
        'Ingoing': ingoing.roundDecimal(2),
        'Outgoing': outgoing.roundDecimal(2)
      }
      break;
    }
  }
  return array;
};

/**
 * Format number to process query
 * @param {Number} num - String to modify
 * 
 * @return {String} formated string 
 */
exports.formatNumber = (num) => {
  return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1 ')
}

/**
 * Create differential array to compare values over years
 * @param {String} region - String to modify
 * 
 * @return {String} formated string 
 */
exports.diff = (array) => {
  for (var country in array) {
    for (var year in array[country]) {
      array[country]['diff'] =
        {
          'value': Number(array[country][eval(year) + 1]['value'] - array[country][year]['value']).roundDecimal(2)
        }
      break;
    }
  }
  return array;
}

/**
 * Get evolution over two years (Y/Y-1)
 * @param {String} region - String to modify
 * 
 * @return {String} formated string 
 */
exports.percentDiff = (oldV, newV, nbVal = [1]) => {
  let obj = {};
  nbVal.forEach(i => {
    obj[`NB${i}`] = (((newV[`NB${i}`]-oldV[`NB${i}`])/oldV[`NB${i}`])*100).roundDecimal(2)
  })
  return obj;
}

/**
 * Round decimal according a given number of decimal
 * @param {Number} nbDec - Number of decimal
 * 
 * @class Number
 * @function roundDecimal
 * @return {Number} formated decimal 
 */
Number.prototype.roundDecimal = function (nbDec) {
  // +(val) => string converted to a Number
  return +(Math.round(this + "e+" + nbDec)  + "e-" + nbDec);
};

/**
 * Capitalize a given string
 * 
 * @class String
 * @function capitalize
 * @return {String} formated string 
 */
String.prototype.capitalize = function () {
  return this.charAt(0).toUpperCase() + this.slice(1);
};

/**
 * Formats string for process query
 * 
 * @class String
 * @function nameQuery
 * @return {String} formated string 
 */
String.prototype.nameQuery = function () {
  return "name_"+this;
};</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon May 06 2019 15:40:02 GMT+0200 (CEST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
